<script>
const messages = document.getElementById("messages");
const clientName = localStorage.getItem("clientName") || "Client";

function bot(text){
  messages.innerHTML += `<div class="msg bot">${text}</div>`;
  messages.scrollTop = messages.scrollHeight;
}

function user(text){
  messages.innerHTML += `<div class="msg user">${text}</div>`;
  messages.scrollTop = messages.scrollHeight;
}

bot(`Bonjour <b>${clientName}</b> üëã<br>
Je suis l‚Äôassistant intelligent de <b>WaveBank</b>.<br>
Je r√©ponds aux questions bancaires simples.<br>
Les op√©rations sensibles n√©cessitent une validation humaine.`);

function send(){
  const input = document.getElementById("userInput");
  const text = input.value.trim();
  if(!text) return;

  user(text);
  input.value = "";

  setTimeout(()=>analyze(text.toLowerCase()),500);
}

function analyze(q){

  /* ====== VIREMENTS ====== */
  if(q.match(/virement|transfer|envoy/)){
    if(q.match(/bloqu|√©chou|pas fait|erreur/)){
      bot("Analyse effectu√©e.<br>‚û° Un virement non ex√©cut√© est g√©n√©ralement li√© √† une v√©rification de s√©curit√© ou √† des informations incorrectes.<br><b>D√©cision :</b> intervention humaine requise.");
    } else {
      bot("Les virements WaveBank sont instantan√©s.<br>Si le b√©n√©ficiaire est correct et le solde suffisant, l‚Äôop√©ration est trait√©e automatiquement.");
    }
    return;
  }

  /* ====== RETRAITS ====== */
  if(q.match(/retrait|retirer|argent/)){
    bot("Un retrait peut √™tre refus√© pour 3 raisons :<br>‚Ä¢ solde insuffisant<br>‚Ä¢ plafond atteint<br>‚Ä¢ restriction temporaire de s√©curit√©<br><b>Aucune action automatique possible.</b>");
    return;
  }

  /* ====== CARTE ====== */
  if(q.match(/carte/)){
    if(q.match(/bloqu|d√©sactiv/)){
      bot("Carte bloqu√©e d√©tect√©e.<br>‚ö† Pour des raisons de s√©curit√© bancaire, une IA ne peut PAS d√©bloquer une carte.<br><b>Un conseiller humain est obligatoire.</b>");
    } else {
      bot("Votre carte permet paiements et retraits.<br>Les param√®tres sensibles sont sous contr√¥le humain.");
    }
    return;
  }

  /* ====== SOLDE ====== */
  if(q.match(/solde|argent|compte/)){
    bot("Pour des raisons de confidentialit√©, l‚Äôacc√®s au solde r√©el est interdit √† une IA.<br>‚û° Consultez votre espace client s√©curis√©.");
    return;
  }

  /* ====== IA / √âTHIQUE ====== */
  if(q.match(/ia|intelligence|robot/)){
    bot("Je suis une intelligence artificielle d‚Äôassistance.<br>Mon r√¥le est d‚Äôaider, pas de d√©cider.<br><b>La supervision humaine est obligatoire dans le secteur bancaire.</b>");
    return;
  }

  /* ====== HUMAIN ====== */
  if(q.match(/conseiller|humain|agent/)){
    bot("Un conseiller humain peut prendre le relais.<br>Horaires : 08h‚Äì18h (jours ouvr√©s).");
    return;
  }

  /* ====== PAR D√âFAUT ====== */
  bot("Demande analys√©e mais non reconnue.<br>Veuillez reformuler ou contacter un conseiller humain.");
}
</script>
